<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Shell notes | leesei&#39;s notebook</title>
  <meta name="author" content="leesei">
  
  <meta name="description" content="Technical blog for the future me and other beings.">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Shell notes"/>
  <meta property="og:site_name" content="leesei&#39;s notebook"/>

  
    <meta property="og:image" content="undefined"/>
  

  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  



</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">leesei&#39;s notebook</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">		
			<h1> Shell notes</h1>
		</div>		
	



<div class="row post">
	<!-- cols -->
	
	<div class="col-md-9">
	

			

	<!-- content -->
	<div class="mypage">		
	    <p>Notes on shell usage.<br>Most of the following are compatible to <code>bash</code> and <code>zsh</code>.</p>
<a id="more"></a>
<h2 id="Choosing_shell"><a href="#Choosing_shell" class="headerlink" title="Choosing shell"></a>Choosing shell</h2><p><a href="http://hyperpolyglot.org/unix-shells" target="_blank" rel="external">Unix Shells: Bash, Fish, Ksh, Tcsh, Zsh - Hyperpolyglot</a></p>
<p>Most distro comes with <code>bash</code> as default login shell.<br>Since <code>bash</code> is ubiquitous and more feature-rich than POSIX shell (<code>/bin/sh</code>), it is recommended to write shell scripts in <code>bash</code>.<br>Since <code>zsh</code> is <code>bash</code> (and hence POSIX) -compatible. Most command lines found on the web can be pasted in <code>zsh</code> directly (unlike <code>fish</code> which is not POSIX-compatible). It is recommended to use <code>zsh</code> as the interactive shell.<br>However I found <code>fish</code> <a href="http://fishshell.com/docs/current/design.html" target="_blank" rel="external">design</a> quite sensible. I’ll try to use external binaries as mush as possible instead of relying on shell features. On the same line of thought, even-though <code>zsh</code> has more powerful syntax than <code>bash</code>, it may not be worthy to use them to avoid lock-in and maintain portability.</p>
<p><a href="https://www.ibm.com/developerworks/linux/library/l-linux-shells/index.html?ca=drs-" target="_blank" rel="external">Evolution of shells in Linux</a></p>
<p>Fish featured on Ars:<br><a href="http://arstechnica.com/information-technology/2005/12/linux-20051218/2/" target="_blank" rel="external">Fish: the friendly interactive shell | Ars Technica</a></p>
<h3 id="login_shell"><a href="#login_shell" class="headerlink" title="login shell"></a>login shell</h3><p>You can set a shell as your default shell with <code>chsh</code>.<br>But interactive shells must be added to <code>/etc/shells</code> first before used as a login shell.</p>
<p><a href="http://fishshell.com/docs/2.1/faq.html#faq-default" target="_blank" rel="external">http://fishshell.com/docs/2.1/faq.html#faq-default</a></p>
<h2 id="dotfiles"><a href="#dotfiles" class="headerlink" title="dotfiles"></a>dotfiles</h2><blockquote>
<p>most contain useful aliases, functions and scripts</p>
</blockquote>
<p>It is recommended to use source control to store your config files (<em>dotfiles</em>, as they usually begins with a <code>.</code>) and use symlinks (<code>ln -s</code>) to deploy them to the machine.</p>
<h3 id="switching_OS_and_host"><a href="#switching_OS_and_host" class="headerlink" title="switching OS and host"></a>switching OS and host</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">SYS_OS=`uname <span class="operator">-a</span>`   <span class="comment"># linux or mac</span></span><br><span class="line">SHORT_HOSTNAME=`hostname <span class="operator">-s</span>`</span><br><span class="line"> </span><br><span class="line"><span class="comment"># system aliases</span></span><br><span class="line"><span class="keyword">if</span> [[ <span class="string">"<span class="variable">$SYS_OS</span>"</span> == <span class="string">'Linux'</span> ]]; <span class="keyword">then</span></span><br><span class="line">     PATH=<span class="string">"..LINUX PATH..."</span></span><br><span class="line">     <span class="built_in">source</span> ~/dotfiles/aliases.lx</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line">     PATH=<span class="string">"... MAC PATH..."</span></span><br><span class="line">     <span class="built_in">source</span> ~/dotfiles/aliases.mac</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># run host specific profile</span></span><br><span class="line"><span class="keyword">if</span> [[ <span class="operator">-e</span> ~/dotfiles/profile.<span class="variable">$SHORT_HOSTNAME</span> ]]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">source</span> ~/dotfiles/profile.<span class="variable">$SHORT_HOSTNAME</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>Honorable mentions:</p>
<ul>
<li><a href="http://dotfiles.github.io/" target="_blank" rel="external">http://dotfiles.github.io/</a></li>
<li><a href="http://chneukirchen.org/dotfiles/" target="_blank" rel="external">http://chneukirchen.org/dotfiles/</a><blockquote>
<p>TODO: add my links in /caravan/github-watch/dotfiles</p>
</blockquote>
</li>
</ul>
<p><a href="http://coda.caseykuhlman.com//entries/2014/dropbox-as-a-settings-repository.html" target="_blank" rel="external">Using Dropbox as a Settings Repository</a></p>
<p><a href="http://siannopollo.blogspot.hk/2007/11/bash-aliases.html" target="_blank" rel="external">Steve’s Blog: bash aliases</a></p>
<h2 id="environment_variable"><a href="#environment_variable" class="headerlink" title="environment variable"></a>environment variable</h2><p><a href="http://www.wikiwand.com/en/Environment_variable" target="_blank" rel="external">Environment variable - Wikiwand</a><br><a href="https://wiki.archlinux.org/index.php/Environment_variables" target="_blank" rel="external">Environment variables - ArchWiki</a></p>
<h2 id="Common_tasks"><a href="#Common_tasks" class="headerlink" title="Common tasks"></a>Common tasks</h2><p><a href="http://www.smallo.ruhr.de/award.html" target="_blank" rel="external">Useless Use of Cat Award</a></p>
<p>Follow <a href="http://www.faqs.org/docs/artu/" target="_blank" rel="external">The Art of Unix Programming</a>, implement filters.<br><a href="http://www.techrepublic.com/blog/software-engineer/simple-filters-in-perl-ruby-and-bourne-shell/" target="_blank" rel="external">Simple filters in Perl, Ruby, and Bourne shell - TechRepublic</a></p>
<p><a href="http://stackoverflow.com/questions/1116992/capturing-output-of-find-print0-into-a-bash-array" target="_blank" rel="external">Capturing output of find . -print0 into a bash array - Stack Overflow</a><br><a href="http://www.dwheeler.com/essays/filenames-in-shell.html" target="_blank" rel="external">Filenames and Pathnames in Shell (bash, dash, ash, ksh, and so on): How to do it Correctly</a></p>
<h3 id="shebang_line"><a href="#shebang_line" class="headerlink" title="shebang line"></a>shebang line</h3><p><a href="http://www.in-ulm.de/~mascheck/various/shebang/" target="_blank" rel="external">The #! magic, details about the shebang/hash-bang mechanism</a><br><a href="http://sambal.org/2014/02/passing-options-node-shebang-line/" target="_blank" rel="external">Sambal : Passing options to node on the shebang (#!) line</a></p>
<p><a href="http://stackoverflow.com/a/25046028/665507" target="_blank" rel="external"><code>envns</code></a><br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span><br><span class="line"></span></span><br><span class="line">ARGS=( <span class="variable">$1</span> )  <span class="comment"># separate $1 into multiple space-delimited arguments.</span></span><br><span class="line"><span class="built_in">shift</span> <span class="comment"># consume $1</span></span><br><span class="line"></span><br><span class="line">PROG=`<span class="built_in">which</span> <span class="variable">$&#123;ARGS[0]&#125;</span>`</span><br><span class="line"><span class="built_in">unset</span> ARGS[<span class="number">0</span>] <span class="comment"># discard executable name</span></span><br><span class="line"></span><br><span class="line">ARGS+=( <span class="string">"<span class="variable">$@</span>"</span> ) <span class="comment"># remainder of arguments preserved "as-is".</span></span><br><span class="line"><span class="built_in">exec</span> <span class="variable">$PROG</span> <span class="string">"<span class="variable">$&#123;ARGS[@]&#125;</span>"</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/local/bin/envns node --harmonic</span></span><br></pre></td></tr></table></figure>
<p><code>node-es6</code>: (alias won’t work in shebang)<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line">node --harmonic <span class="string">"<span class="variable">$@</span>"</span></span><br></pre></td></tr></table></figure></p>
<h3 id="parsing_command_line"><a href="#parsing_command_line" class="headerlink" title="parsing command line"></a>parsing command line</h3><p><a href="http://www.shelldorado.com/goodcoding/cmdargs.html" target="_blank" rel="external">SHELLdorado - cmdargs</a><br><a href="http://www.bahmanm.com/blogs/command-line-options-how-to-parse-in-bash-using-getopt" target="_blank" rel="external">Command Line Options: How To Parse In Bash Using “getopt” — BahmanM.com</a></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># http://www.bahmanm.com/blogs/command-line-options-how-to-parse-in-bash-using-getopt</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># “a” and “arga” have optional arguments with default values.</span></span><br><span class="line"><span class="comment"># “b” and “argb” have no arguments, acting as sort of a flag.</span></span><br><span class="line"><span class="comment"># “c” and “argc” have required arguments.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># e.g.:</span></span><br><span class="line"><span class="comment"># ./getopt.sh  1 -a'a' -b 2 -c'c' 3 4</span></span><br><span class="line"><span class="comment"># ./getopt.sh  1 --arga='a' 2 --argc='c' 3 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># set an initial value for the flag</span></span><br><span class="line">ARG_B=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># read the options</span></span><br><span class="line">TEMP=`getopt -o a::bc: --long arga::,argb,argc: -n <span class="string">'getopt.sh'</span> -- <span class="string">"<span class="variable">$@</span>"</span>`</span><br><span class="line"><span class="keyword">if</span> [[ $? <span class="operator">-ne</span> <span class="number">0</span> ]]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"\e[1;31m"</span><span class="string">"getopt error"</span><span class="string">"\e[0m"</span></span><br><span class="line">    <span class="built_in">exit</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">eval</span> <span class="built_in">set</span> -- <span class="string">"<span class="variable">$TEMP</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># extract options and their arguments into variables.</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span> ; <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></span><br><span class="line">        <span class="operator">-a</span>|--arga)</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"<span class="variable">$2</span>"</span> <span class="keyword">in</span></span><br><span class="line">                <span class="string">""</span>) ARG_A=<span class="string">'some default value'</span> ; <span class="built_in">shift</span> <span class="number">2</span> ;;</span><br><span class="line">                *) ARG_A=<span class="variable">$2</span> ; <span class="built_in">shift</span> <span class="number">2</span> ;;</span><br><span class="line">            <span class="keyword">esac</span> ;;</span><br><span class="line">        -b|--argb) ARG_B=<span class="number">1</span> ; <span class="built_in">shift</span> ;;</span><br><span class="line">        -c|--argc)</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"<span class="variable">$2</span>"</span> <span class="keyword">in</span></span><br><span class="line">                <span class="string">""</span>) <span class="built_in">shift</span> <span class="number">2</span> ;;</span><br><span class="line">                *) ARG_C=<span class="variable">$2</span> ; <span class="built_in">shift</span> <span class="number">2</span> ;;</span><br><span class="line">            <span class="keyword">esac</span> ;;</span><br><span class="line">        --) <span class="built_in">shift</span> ; <span class="built_in">break</span> ;;</span><br><span class="line">        *) <span class="built_in">echo</span> <span class="string">"Internal error!"</span> ; <span class="built_in">exit</span> <span class="number">2</span> ;;</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># do something with the variables -- in this case the lamest possible one :-)</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"ARG_A = <span class="variable">$ARG_A</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"ARG_B = <span class="variable">$ARG_B</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"ARG_C = <span class="variable">$ARG_C</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># positional args</span></span><br><span class="line">args=(<span class="string">"<span class="variable">$@</span>"</span>)</span><br><span class="line"><span class="built_in">echo</span> \<span class="comment">#: [$&#123;#args[@]&#125;]</span></span><br><span class="line"><span class="built_in">echo</span> @: [<span class="variable">$&#123;args[@]&#125;</span>]</span><br><span class="line"><span class="keyword">for</span> ((i=<span class="number">0</span>; i&lt;<span class="variable">$&#123;#args[@]&#125;</span>; i++)); <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$&#123;args[i]&#125;</span>;</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="redirection"><a href="#redirection" class="headerlink" title="redirection"></a>redirection</h3><p>All these redirections are equal:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ &gt; file <span class="built_in">command</span> arg1 arg2 arg3</span><br><span class="line">$ <span class="built_in">command</span> &gt; file arg1 arg2 arg3</span><br><span class="line">$ <span class="built_in">command</span> arg1 &gt; file arg2 arg3</span><br><span class="line">$ <span class="built_in">command</span> arg1 arg2 &gt; file arg3</span><br><span class="line">$ <span class="built_in">command</span> arg1 arg2 arg3 &gt; file</span><br></pre></td></tr></table></figure>
<h3 id="Here_Doc"><a href="#Here_Doc" class="headerlink" title="Here Doc"></a>Here Doc</h3><p><a href="http://stackoverflow.com/questions/2953081/how-can-i-write-a-here-doc-to-a-file-in-bash-script" target="_blank" rel="external">linux - How can I write a here doc to a file in Bash script? - Stack Overflow</a><br><a href="http://tldp.org/LDP/abs/html/here-docs.html" target="_blank" rel="external">Here Documents</a></p>
<p>This is a technique to embed string block in scripts and feed it to an interactive command.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">interactive-program &lt;&lt;LimitString</span><br><span class="line"><span class="built_in">command</span> <span class="comment">#1</span></span><br><span class="line"><span class="built_in">command</span> <span class="comment">#2</span></span><br><span class="line">...</span><br><span class="line">LimitString</span><br></pre></td></tr></table></figure>
<p>Single quote (<code>&#39;</code>) the commands to prevent string interpolation.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cat &lt;&lt; <span class="string">'EOF'</span></span><br><span class="line">I want to <span class="built_in">print</span> <span class="variable">$&#123;FOO&#125;</span> literally</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
<p><code>&lt;&lt;-</code> will suppress leading tabs (not spaces).</p>
<h3 id="detect_undefined_variables"><a href="#detect_undefined_variables" class="headerlink" title="detect undefined variables"></a>detect undefined variables</h3><p>it’s more meaningful in scripts to report error then to continue with empty string</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">set</span> -u  <span class="comment"># throw error on uninitialized variable, `set -o nounset`</span></span><br><span class="line"><span class="built_in">set</span> <span class="operator">-e</span>  <span class="comment"># exit on statement error, `set -o errexit`</span></span><br></pre></td></tr></table></figure>
<h3 id="key_bindings"><a href="#key_bindings" class="headerlink" title="key bindings"></a>key bindings</h3><p><a href="http://www.ice2o.com/bash_quick_ref.html" target="_blank" rel="external">Bash Shortcuts Quick Reference</a></p>
<h3 id="color"><a href="#color" class="headerlink" title="color"></a>color</h3><p><a href="http://misc.flogisoft.com/bash/tip_colors_and_formatting" target="_blank" rel="external">http://misc.flogisoft.com/bash/tip_colors_and_formatting</a><br><a href="http://www.calmar.ws/vim/256-xterm-24bit-rgb-color-chart.html" target="_blank" rel="external">http://www.calmar.ws/vim/256-xterm-24bit-rgb-color-chart.html</a></p>
<p>zsh have color macros predefined, see themes in <code>oh-my-zsh</code></p>
<h3 id="power_tools"><a href="#power_tools" class="headerlink" title="power tools"></a>power tools</h3><p><a href="https://github.com/mbrubeck/compleat" target="_blank" rel="external">mbrubeck/compleat</a></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">zstyle</span> -L <span class="string">":completion:*"</span></span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/clvv/fasd" target="_blank" rel="external">clvv/fasd</a></p>
<p><a href="https://github.com/rupa/z" target="_blank" rel="external">rupa/z</a></p>
<h3 id="calculation"><a href="#calculation" class="headerlink" title="calculation"></a>calculation</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># do math calculation in $(( )), it is faster then `expr`</span></span><br><span class="line"><span class="comment"># and we can specify the number system with 8#, 10#, 16#</span></span><br><span class="line"><span class="comment"># useful for doing operation on variables with leading zeros</span></span><br><span class="line">a=<span class="number">005</span></span><br><span class="line">$((<span class="number">10</span><span class="comment">#$&#123;a&#125; + 1))</span></span><br><span class="line">$(expr <span class="variable">$&#123;a&#125;</span> + <span class="number">1</span>)  <span class="comment"># slower</span></span><br></pre></td></tr></table></figure>
<p>or use <code>bc</code>, or use <code>math</code> (inspired by <code>fish</code>)</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="shebang">#!/bin/sh</span></span><br><span class="line"><span class="comment"># thin wrapper around bc for easier math expression in shell</span></span><br><span class="line"><span class="comment"># inspired by fish</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$@</span>"</span> | bc <span class="operator">-l</span></span><br></pre></td></tr></table></figure>
<h3 id="trap"><a href="#trap" class="headerlink" title="trap"></a>trap</h3><blockquote>
<p><code>bash</code> specific?</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># clean up</span></span><br><span class="line"><span class="built_in">trap</span> cleanUp INT TERM EXIT</span><br><span class="line"><span class="comment"># cannot be killed</span></span><br><span class="line"><span class="built_in">trap</span> - INT TERM EXIT</span><br></pre></td></tr></table></figure>
<h3 id="proper_critical_section"><a href="#proper_critical_section" class="headerlink" title="proper critical section"></a>proper critical section</h3><blockquote>
<p><code>bash</code> specific?</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [ ! <span class="operator">-e</span> <span class="variable">$lockfile</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">trap</span> <span class="string">"rm -f <span class="variable">$lockfile</span>; exit"</span> INT TERM EXIT</span><br><span class="line">    touch <span class="variable">$lockfile</span></span><br><span class="line">    critical-section</span><br><span class="line">    rm <span class="variable">$lockfile</span></span><br><span class="line">    <span class="built_in">trap</span> - INT TERM EXIT</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"critical-section is already running"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h2 id="Shell_Script_Constructs"><a href="#Shell_Script_Constructs" class="headerlink" title="Shell Script Constructs"></a>Shell Script Constructs</h2><p><a href="http://zsh.sourceforge.net/Doc/Release/Shell-Grammar.html" target="_blank" rel="external">http://zsh.sourceforge.net/Doc/Release/Shell-Grammar.html</a></p>
<h3 id="if"><a href="#if" class="headerlink" title="<code>if</code>"></a><code>if</code></h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># if construct</span></span><br><span class="line"><span class="keyword">if</span> [[ -z <span class="string">"<span class="variable">$1</span>"</span> || -z <span class="string">"<span class="variable">$2</span>"</span> ]]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Usage: <span class="variable">$0</span> &lt;command&gt; &lt;arg&gt;"</span></span><br><span class="line">    <span class="built_in">exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># test existence of binary</span></span><br><span class="line"><span class="keyword">if</span> [[ -z <span class="string">"<span class="variable">$(which wget)</span>"</span> ]]; <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">do</span>Something</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">[[ $(<span class="built_in">which</span> colordiff) ]] &amp;&amp; <span class="built_in">alias</span> diff=<span class="string">'colordiff '</span></span><br></pre></td></tr></table></figure>
<h3 id="case"><a href="#case" class="headerlink" title="<code>case</code>"></a><code>case</code></h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="string">'$param'</span> <span class="keyword">in</span></span><br><span class="line">A)</span><br><span class="line">    ;;</span><br><span class="line">B)</span><br><span class="line">    ;;</span><br><span class="line">*)</span><br><span class="line">    ;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># choose 'open' command</span></span><br><span class="line"><span class="keyword">case</span> $(uname) <span class="keyword">in</span></span><br><span class="line">    Darwin) OPEN_CMD=open ;;</span><br><span class="line">    Linux) OPEN_CMD=xdg-open ;; <span class="comment"># assuming X is present</span></span><br><span class="line">    CYGWIN*) OPEN_CMD=cygstart ;;</span><br><span class="line">    *) <span class="built_in">echo</span> <span class="string">"Unknown OS"</span>; <span class="built_in">exit</span> <span class="number">1</span> ;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>
<h3 id="for"><a href="#for" class="headerlink" title="<code>for</code>"></a><code>for</code></h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> `ls -v` ; <span class="keyword">do</span> cat <span class="variable">$file</span> &gt;&gt; concat.file ; <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> `ls -v` ; <span class="keyword">do</span></span><br><span class="line">    cat <span class="variable">$file</span> &gt;&gt; concat.file ;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &#123;START..END..INCREMENT&#125;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;<span class="number">1</span>..<span class="number">5</span>&#125;; <span class="keyword">do</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"Welcome <span class="variable">$i</span> times"</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="while"><a href="#while" class="headerlink" title="<code>while</code>"></a><code>while</code></h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> [ -z <span class="variable">$1</span> ] ; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$1</span></span><br><span class="line">    <span class="built_in">shift</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="until"><a href="#until" class="headerlink" title="<code>until</code>"></a><code>until</code></h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">until [ -z <span class="variable">$1</span> ] ; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$1</span></span><br><span class="line">    <span class="built_in">shift</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="array"><a href="#array" class="headerlink" title="array"></a>array</h3><p><a href="http://www.artificialworlds.net/blog/2012/10/17/bash-associative-array-examples/" target="_blank" rel="external">Bash associative array examples | Andy Balaam’s Blog</a><br><a href="http://www.artificialworlds.net/blog/2013/09/18/bash-arrays/" target="_blank" rel="external">Bash arrays | Andy Balaam’s Blog</a><br><a href="http://www.thegeekstuff.com/2010/06/bash-array-tutorial/" target="_blank" rel="external">The Ultimate Bash Array Tutorial with 15 Examples</a></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cherries+=(<span class="number">54758</span>)</span><br><span class="line">cherries+=(<span class="number">54761</span>)</span><br><span class="line">cherries+=(<span class="number">55075</span>)</span><br><span class="line"><span class="comment"># stringify array</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;cherries[@]&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># construct array form string</span></span><br><span class="line">FILES=(<span class="string">"<span class="variable">$&#123;@&#125;</span>"</span>)</span><br><span class="line">NUMFILES=<span class="variable">$&#123;#FILES[@]&#125;</span></span><br><span class="line"><span class="keyword">for</span> (( i = <span class="number">0</span>; i &lt; <span class="variable">$&#123;NUMFILES&#125;</span>; i++ )); <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$&#123;FILES[$&#123;i&#125;</span>]&#125;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment"># "$&#123;!array[*]&#125;" "$&#123;array[*]&#125;"?</span></span><br><span class="line"><span class="comment"># keys: $&#123;!array[@]&#125;</span></span><br><span class="line"><span class="comment"># values $&#123;array[@]&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="passing_array_to_function"><a href="#passing_array_to_function" class="headerlink" title="passing array to function"></a>passing array to function</h4><p><a href="http://stackoverflow.com/questions/16461656/bash-how-to-pass-array-as-an-argument-to-a-function" target="_blank" rel="external">bash how to pass array as an argument to a function - Stack Overflow</a><br><a href="http://stackoverflow.com/questions/1063347/passing-arrays-as-parameters-in-bash" target="_blank" rel="external">Passing arrays as parameters in bash - Stack Overflow</a></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># stringify and reconstruct</span></span><br><span class="line"><span class="function"><span class="title">foo</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">    array=(<span class="string">"<span class="variable">$@</span>"</span>)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"array is <span class="variable">$&#123;array[@]&#125;</span>"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">array=(one two three)</span><br><span class="line">foo <span class="string">"<span class="variable">$&#123;array[@]&#125;</span>"</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># by reference</span></span><br><span class="line"><span class="function"><span class="title">foo</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"># note: must use a name different from "array"</span></span><br><span class="line">    <span class="built_in">local</span> -n a=<span class="variable">$1</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"array is <span class="variable">$&#123;a[@]&#125;</span>"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">array=(one two three)</span><br><span class="line">foo array</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># by reference</span></span><br><span class="line"><span class="function"><span class="title">foo</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"># note: must use a name different from "array1", "array2"</span></span><br><span class="line">    <span class="built_in">declare</span> <span class="operator">-a</span> argAry1=(<span class="string">"<span class="variable">$&#123;!1&#125;</span>"</span>)</span><br><span class="line">    <span class="built_in">declare</span> <span class="operator">-a</span> argAry2=(<span class="string">"<span class="variable">$&#123;!2&#125;</span>"</span>)</span><br><span class="line">    <span class="built_in">declare</span> -p argAry1</span><br><span class="line">    <span class="built_in">declare</span> -p argAry2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">array1=(one two three)</span><br><span class="line">array2=(a b c)</span><br><span class="line">foo array1[@] array2[@]</span><br></pre></td></tr></table></figure>
<h3 id="function"><a href="#function" class="headerlink" title="function"></a>function</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># test element in array</span></span><br><span class="line"><span class="function"><span class="title">in_array</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">local</span> hay needle=<span class="variable">$1</span>;</span><br><span class="line">    <span class="built_in">shift</span>;</span><br><span class="line">    <span class="keyword">for</span> hay <span class="keyword">in</span> <span class="string">"<span class="variable">$@</span>"</span>; <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$hay</span></span><br><span class="line">        [[ <span class="variable">$hay</span> == <span class="variable">$needle</span> ]] &amp;&amp; <span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">done</span>;</span><br><span class="line">    <span class="built_in">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># test logic expression</span></span><br><span class="line"><span class="function"><span class="title">Test</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">eval</span> <span class="string">"<span class="variable">$@</span>"</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">"True"</span> || <span class="built_in">echo</span> <span class="string">"False"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="http://aurelio.net/articles/shell-reference.html" target="_blank" rel="external">Bash Shell Quick Reference, by Aurelio Jargas</a><br><a href="http://linuxcommand.org/tlcl.php" target="_blank" rel="external">The Linux Command Line by William E. Shotts, Jr.</a><br><a href="http://www.linux.org/forums/shell-command-line.49/" target="_blank" rel="external">Shell / Command Line | Linux.org</a><br><a href="http://www.tldp.org/LDP/GNU-Linux-Tools-Summary/html/index.html" target="_blank" rel="external">GNU/Linux Command-Line Tools Summary</a><br><a href="http://www.shelldorado.com/" target="_blank" rel="external">Heiner’s SHELLdorado</a><br><a href="https://www.digitalocean.com/community/tutorial_series/an-introduction-to-shell-scripting" target="_blank" rel="external">An Introduction to Shell Scripting | DigitalOcean</a></p>
<p><strong>Bash</strong>:<br><a href="http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO.html" target="_blank" rel="external">BASH Programming - Introduction HOW-TO</a><br><a href="http://www.tldp.org/LDP/Bash-Beginners-Guide/html/Bash-Beginners-Guide.html" target="_blank" rel="external">Bash Guide for Beginners</a><br><a href="http://www.tldp.org/LDP/abs/html/" target="_blank" rel="external">Advanced Bash-Scripting Guide</a><br><a href="http://wiki.bash-hackers.org/doku.php" target="_blank" rel="external">Bash Hackers Wiki Frontpage [Bash Hackers Wiki]</a><br><a href="http://justinlilly.com/bash/forgotten_friend_1.html" target="_blank" rel="external">http://justinlilly.com/bash/forgotten_friend_1.html</a><br><a href="http://justinlilly.com/bash/forgotten_friend_2.html" target="_blank" rel="external">http://justinlilly.com/bash/forgotten_friend_2.html</a><br><a href="http://justinlilly.com/bash/forgotten_friend_3.html" target="_blank" rel="external">http://justinlilly.com/bash/forgotten_friend_3.html</a><br><a href="http://www.dsj.net/compedge/shellbasics.html" target="_blank" rel="external">http://www.dsj.net/compedge/shellbasics.html</a><br><a href="http://www.dsj.net/compedge/shellbasics1.html" target="_blank" rel="external">http://www.dsj.net/compedge/shellbasics1.html</a><br><a href="http://www.dsj.net/compedge/regex.html" target="_blank" rel="external">http://www.dsj.net/compedge/regex.html</a><br><a href="http://www.dsj.net/compedge/morebashfun2.html" target="_blank" rel="external">http://www.dsj.net/compedge/morebashfun2.html</a><br><a href="http://www.dsj.net/compedge/bashit.html" target="_blank" rel="external">http://www.dsj.net/compedge/bashit.html</a></p>
<p><strong>Zsh</strong>:<br><a href="http://zsh.sourceforge.net/Doc/Release/zsh_toc.html" target="_blank" rel="external">http://zsh.sourceforge.net/Doc/Release/zsh_toc.html</a><br><a href="http://grml.org/zsh/zsh-lovers.html" target="_blank" rel="external">http://grml.org/zsh/zsh-lovers.html</a><br><a href="http://www.zzapper.co.uk/zshtips.html" target="_blank" rel="external">http://www.zzapper.co.uk/zshtips.html</a><br><a href="http://fendrich.se/blog/2012/09/28/no/" target="_blank" rel="external">http://fendrich.se/blog/2012/09/28/no/</a><br><a href="http://www.tuxradar.com/content/z-shell-made-easy" target="_blank" rel="external">http://www.tuxradar.com/content/z-shell-made-easy</a></p>
<p><strong>Fish</strong>:<br><a href="https://wiki.archlinux.org/index.php/Fish" target="_blank" rel="external">https://wiki.archlinux.org/index.php/Fish</a></p>
	  
	</div>

	<div>
  	<center>
	<div class="pagination">
<ul class="pagination">
	 
				
    	<li class="prev"><a href="/debian-ubuntu-notes/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>Prev</a></li>
  		

        <li><a href="/archives"><i class="fa fa-archive"></i>Archive</a></li>

		
		   <li class="next"><a href="/shell-history-expansion/" class="alignright next">Next<i class="fa fa-arrow-circle-o-right"></i></a></li>         
        
	
</ul>
</div>

    </center>
	</div>
	
	<!-- comment -->
	
<section id="comment">
  <h2 class="title">Comments</h2>

  
  	 <div id="disqus_thread">
     <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  	 </div>
  
</section>

	
	</div> <!-- col-md-9/col-md-12 -->
	
	
		<div class="col-md-3"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2014-12-08 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/linux/">linux<span>18</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/notes/">notes<span>19</span></a></li> <li><a href="/tags/shell/">shell<span>5</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
			<ol class="toc-article"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Choosing_shell"><span class="toc-article-text">Choosing shell</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#login_shell"><span class="toc-article-text">login shell</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#dotfiles"><span class="toc-article-text">dotfiles</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#switching_OS_and_host"><span class="toc-article-text">switching OS and host</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#environment_variable"><span class="toc-article-text">environment variable</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Common_tasks"><span class="toc-article-text">Common tasks</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#shebang_line"><span class="toc-article-text">shebang line</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#parsing_command_line"><span class="toc-article-text">parsing command line</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#redirection"><span class="toc-article-text">redirection</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Here_Doc"><span class="toc-article-text">Here Doc</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#detect_undefined_variables"><span class="toc-article-text">detect undefined variables</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#key_bindings"><span class="toc-article-text">key bindings</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#color"><span class="toc-article-text">color</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#power_tools"><span class="toc-article-text">power tools</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#calculation"><span class="toc-article-text">calculation</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#trap"><span class="toc-article-text">trap</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#proper_critical_section"><span class="toc-article-text">proper critical section</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Shell_Script_Constructs"><span class="toc-article-text">Shell Script Constructs</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#if"><span class="toc-article-text">if</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#case"><span class="toc-article-text">case</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#for"><span class="toc-article-text">for</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#while"><span class="toc-article-text">while</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#until"><span class="toc-article-text">until</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#array"><span class="toc-article-text">array</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#passing_array_to_function"><span class="toc-article-text">passing array to function</span></a></li></ol></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#function"><span class="toc-article-text">function</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Reference"><span class="toc-article-text">Reference</span></a></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	

</div><!-- row -->

	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2015 leesei
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a> (customized by <a href="https://github.com/leesei/hexo-theme-freemind/tree/leesei.github.io">leesei</a>).
</p>
 </footer>
</div> <!-- container-narrow -->
  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>


<script type="text/javascript">
var disqus_shortname = 'leesei';
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


</body>
   </html>
